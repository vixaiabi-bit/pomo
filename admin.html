<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen p-6">
<div id="loginBox" class="max-w-sm mx-auto bg-gray-800 p-6 rounded-lg shadow-lg">
  <h2 class="text-xl font-bold mb-4 text-center">Admin Login</h2>
  <input id="pass" type="password" placeholder="Enter Password" class="w-full p-3 mb-4 rounded text-black">
  <button onclick="login()" class="w-full bg-blue-600 py-2 rounded">Login</button>
  <p id="loginMsg" class="text-red-400 mt-3 text-center"></p>
</div>

<div id="adminPanel" class="hidden">
  <h1 class="text-3xl font-bold mb-6 text-center">Admin Dashboard</h1>

  <div class="bg-gray-800 p-6 rounded-lg mb-6">
    <h2 class="text-xl font-bold mb-3">Bulk Upload Promo Codes</h2>
    <textarea id="bulkCodes" class="w-full p-3 rounded text-black h-40" placeholder="Enter one code per line"></textarea>
    <button onclick="uploadBulk()" class="mt-3 w-full bg-green-600 py-2 rounded">Upload Codes</button>
    <p id="bulkMsg" class="text-yellow-300 mt-3"></p>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="bg-gray-800 p-6 rounded-lg">
      <h2 class="text-xl font-bold mb-4">Unused Promo Codes</h2>
      <ul id="unusedList" class="space-y-1 text-green-300"></ul>
    </div>
    <div class="bg-gray-800 p-6 rounded-lg">
      <h2 class="text-xl font-bold mb-4">Used Promo Codes</h2>
      <ul id="usedList" class="space-y-1 text-red-300"></ul>
    </div>
  </div>
</div>

<script>
const ADMIN_PASS="Rock@2410";

const firebaseConfig = {
  apiKey: "AIzaSyA-4XRLaGKrLKPwY5rardVa7S6gOGaD4Ds",
  authDomain: "rizz-eca27.firebaseapp.com",
  projectId: "rizz-eca27",
  storageBucket: "rizz-eca27.firebasestorage.app",
  messagingSenderId: "979930238042",
  appId: "1:979930238042:web:8cc5fb3060b62f81eb9c63",
  measurementId: "G-5QCFLE8WSG"
};

firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

function login(){
  let p=document.getElementById("pass").value;
  if(p===ADMIN_PASS){
    document.getElementById("loginBox").classList.add("hidden");
    document.getElementById("adminPanel").classList.remove("hidden");
    loadData();
  } else {
    document.getElementById("loginMsg").innerText="Wrong password!";
  }
}

async function uploadBulk(){
  let text=document.getElementById("bulkCodes").value.trim();
  let msg=document.getElementById("bulkMsg");
  if(!text){ msg.innerText="Enter codes first."; return; }
  let codes=text.split(/\n+/).map(c=>c.trim()).filter(c=>c.length>0);
  let added=0, skipped=0;
  for(let code of codes){
    let docRef=db.collection("promo_codes").doc(code);
    let exists=await docRef.get();
    if(exists.exists){ skipped++; }
    else { await docRef.set({ used:false }); added++; }
  }
  msg.innerText=`Added: ${added}, Skipped: ${skipped}`;
  loadData();
}

async function loadData(){
  let unused=document.getElementById("unusedList");
  let used=document.getElementById("usedList");
  unused.innerHTML=""; used.innerHTML="";
  let snap=await db.collection("promo_codes").get();
  snap.forEach(doc=>{
    if(doc.data().used){ used.innerHTML += `<li>${doc.id}</li>`; }
    else { unused.innerHTML += `<li>${doc.id}</li>`; }
  });
}
</script>
</body>
</html>
